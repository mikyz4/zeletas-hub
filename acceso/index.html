<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>TEST LOGIN</title>
</head>
<body>
    <h1>Probando conexión...</h1>
    <button id="btnGoogle" style="padding: 20px; background: blue; color: white;">ENTRAR CON GOOGLE</button>

    <script src="https://unpkg.com/@supabase/supabase-js@1.35.7/dist/umd/supabase.js"></script>

    <script>
        // ESTO TIENE QUE SALIR SÍ O SÍ
        alert("¡EL SCRIPT ESTÁ VIVO!");

        const SUPABASE_URL = "https://sbqpkfdcznulwpxlxiwu.supabase.co";
        const SUPABASE_ANON_KEY = "sb_publishable_9dX-ESpW0YwCaFfDR0aMAg_9PLvO2oo";
        
        // Inicialización manual para evitar errores de librería
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function verificar() {
            const user = supabase.auth.user();
            if (user) {
                alert("SESIÓN OK: " + user.email);
                window.location.href = "../perfil/index.html";
            } else if (window.location.hash.includes('access_token')) {
                alert("VECO EL TOKEN, PERO SUPABASE NO LO PROCESA AUTOMÁTICAMENTE");
            }
        }

        document.getElementById('btnGoogle').onclick = async () => {
            await supabase.auth.signIn({ provider: 'google' });
        };

        verificar();
    </script>
</body>
</html>
