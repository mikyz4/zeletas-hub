<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil P√∫blico - ZELETAS HUB</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
  <style>
    body { background-color: var(--bg); color: var(--text); padding-bottom: 60px; }
    .profile-page { max-width: 1000px; margin: 0 auto; padding: 20px; }

    /* --- CABECERA DE IDENTIDAD --- */
    .profile-card-main {
      background: var(--bg2);
      border-radius: 28px;
      border: 1px solid var(--border);
      padding: 40px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    .profile-cover {
      position: absolute;
      top: 0; left: 0; right: 0; height: 120px;
      background: linear-gradient(90deg, #1a1a1a, var(--green), #1a1a1a);
      opacity: 0.15;
    }
    .profile-avatar-v2 {
      width: 130px; height: 130px;
      border-radius: 50%;
      border: 4px solid var(--green);
      position: relative;
      margin: 0 auto 20px;
      background: var(--card);
      z-index: 1;
    }
    .online-indicator {
      width: 18px; height: 18px;
      background: var(--green);
      border: 3px solid var(--bg2);
      border-radius: 50%;
      position: absolute;
      bottom: 10px; right: 10px;
    }

    /* --- SECCI√ìN DE BIOGRAF√çA Y DATOS --- */
    .user-bio-section {
      background: var(--card);
      border-radius: 20px;
      padding: 25px;
      margin-top: 25px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .bio-text { color: var(--muted); font-style: italic; margin-bottom: 20px; line-height: 1.6; }
    
    /* --- FUNCIONES DE USUARIO AVANZADAS --- */
    .user-features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }
    .feature-box {
      background: var(--bg2);
      border-radius: 18px;
      padding: 20px;
      border: 1px solid var(--border);
    }
    .feature-box h4 { color: var(--green); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }

    /* --- SISTEMA DE MEDALLAS Y LOGROS --- */
    .badges-container { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 15px; }
    .medal {
      background: rgba(0, 200, 83, 0.1);
      border: 1px solid var(--border);
      padding: 5px 12px;
      border-radius: 8px;
      font-size: 0.75rem;
      color: var(--green);
      font-weight: 700;
    }

    /* --- INPUTS ESTILO ZELETAS --- */
    .edit-input {
      width: 100%;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.1);
      padding: 10px;
      border-radius: 8px;
      color: var(--text);
      margin-top: 10px;
    }

    .btn-save {
      background: var(--green);
      color: var(--bg);
      border: none;
      padding: 10px 25px;
      border-radius: 12px;
      font-weight: 800;
      cursor: pointer;
      margin-top: 20px;
    }
  </style>
</head>
<body>

<div class="profile-page">
  <div class="profile-card-main">
    <div class="profile-cover"></div>
    <div class="profile-avatar-v2">
      <img id="userImg" src="" alt="Foto Perfil" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">
      <div class="online-indicator"></div>
    </div>
    <h2 id="userNameDisplay">...</h2>
    <p id="userStatusDisplay" style="color:var(--green); font-weight:600; font-size: 0.9rem;">Verificado por Zeletas Hub</p>
    
    <div class="badges-container">
      <span class="medal">üèÜ Vendedor Pro</span>
      <span class="medal">‚≠ê 5.0 Rese√±as</span>
      <span class="medal">üõ°Ô∏è Identidad Validada</span>
    </div>
  </div>

  <div class="user-bio-section">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h3>Sobre m√≠</h3>
      <button class="btn-tech" id="editBioBtn">Editar Bio</button>
    </div>
    <p class="bio-text" id="bioText">"Bienvenido a mi perfil oficial en Zeletas Hub. Aqu√≠ gestiono mis anuncios y servicios con total transparencia y calidad."</p>
    <div id="editArea" style="display:none;">
       <textarea class="edit-input" id="bioInput" rows="3"></textarea>
       <button class="btn-save" id="saveBioBtn">Guardar Cambios</button>
    </div>
  </div>

  <div class="user-features-grid">
    
    <div class="feature-box">
      <h4><span>üìû</span> Datos de Contacto P√∫blico</h4>
      <div class="pro-item">
        <span>WhatsApp:</span>
        <input type="text" class="edit-input" placeholder="+34 000 000 000">
      </div>
      <div class="pro-item" style="margin-top:10px;">
        <span>Localizaci√≥n:</span>
        <select class="edit-input">
          <option>Madrid, Espa√±a</option>
          <option>Barcelona, Espa√±a</option>
        </select>
      </div>
    </div>

    <div class="feature-box">
      <h4><span>ü§ù</span> Preferencias de Trato</h4>
      <div class="pro-item">
        <p class="listing-meta">¬øC√≥mo prefieres que te contacten?</p>
        <div style="display:flex; gap:10px; margin-top:10px;">
          <label><input type="checkbox" checked> Chat</label>
          <label><input type="checkbox"> Llamada</label>
          <label><input type="checkbox" checked> WhatsApp</label>
        </div>
      </div>
    </div>

    <div class="feature-box">
      <h4><span>üåê</span> Redes Sociales</h4>
      <div class="pro-item">
        <span>Instagram:</span>
        <input type="text" class="edit-input" placeholder="@usuario">
      </div>
      <div class="pro-item" style="margin-top:10px;">
        <span>Sitio Web:</span>
        <input type="text" class="edit-input" placeholder="www.tuweb.com">
      </div>
    </div>

    <div class="feature-box">
      <h4><span>üìä</span> M√©tricas de Confianza</h4>
      <div class="pro-list">
        <div class="pro-item"><span>Antig√ºedad:</span> <span>1 a√±o</span></div>
        <div class="pro-item"><span>Tiempo resp:</span> <span>< 1 hora</span></div>
        <div class="pro-item"><span>Ventas √©xito:</span> <span>42</span></div>
      </div>
    </div>

  </div>

  <div style="text-align:center; margin-top:40px;">
    <a href="./configuracion.html" class="btn btn-secondary">Ir a Ajustes del Sistema</a>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const S_URL = "https://sbqpkfdcznulwpxlxiwu.supabase.co";
  const S_KEY = "sb_publishable_9dX-ESpW0YwCaFfDR0aMAg_9PLvO2oo";
  const supabaseClient = supabase.createClient(S_URL, S_KEY);

  async function cargarPerfil() {
    const { data: { session } } = await supabaseClient.auth.getSession();
    if (session) {
      const user = session.user;
      document.getElementById('userNameDisplay').textContent = user.user_metadata?.full_name || "Usuario Zeletas";
      if (user.user_metadata?.avatar_url) document.getElementById('userImg').src = user.user_metadata.avatar_url;
      
      // Aqu√≠ podr√≠as cargar la BIO desde una tabla de Supabase llamada 'perfiles'
    } else { window.location.href = "../index.html"; }
  }

  // L√≥gica sencilla para editar Bio
  const editBioBtn = document.getElementById('editBioBtn');
  const editArea = document.getElementById('editArea');
  const bioText = document.getElementById('bioText');
  const bioInput = document.getElementById('bioInput');

  editBioBtn.onclick = () => {
    editArea.style.display = 'block';
    bioInput.value = bioText.textContent;
    bioText.style.display = 'none';
  };

  document.getElementById('saveBioBtn').onclick = () => {
    bioText.textContent = bioInput.value;
    editArea.style.display = 'none';
    bioText.style.display = 'block';
    alert("Bio actualizada en tu perfil p√∫blico.");
  };

  window.onload = cargarPerfil;
</script>
</body>
</html>
